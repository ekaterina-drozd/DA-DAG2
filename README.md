# DA-DAG2
 
**Задачи**:
* Определить год, за который смотрим данные (1994 + hash(f‘{login}') % 23)
* Создать DAG с тасками, отвечающими на следующие вопросы:
1. Какая игра была самой продаваемой в этом году во всем мире?
2. Игры какого жанра были самыми продаваемыми в Европе?Перечислить все, если их несколько
3. На какой платформе было больше всего игр, которые продались более чем миллионным тиражом в Северной Америке? Перечислить все, если их несколько
4. У какого издателя самые высокие средние продажи в Японии? Перечислить все, если их несколько
5. Сколько игр продались лучше в Европе, чем в Японии?

Интервал выполнения - ежедневно 

**Стек:** python, библиотеки pandas, requests, datetime, airflow 

**Этапы работы:** 
- подгрузила необходимые данные
- определила год, за который смотрим данные
- прописала таски:
- определила самую продаваемую игру за этот год
- определила самые продаваемые жанры игр за этот год
- отобрала данные по Северной Америке и определила, на какой платформе было больше всего игр, которые продались более чем миллионным тиражом
- отобрала данные по Японии и определила издателей с самыми высокими средними продажами
- посчитала, сколько игр продались лучше в Европе, чем в Японии 
- инициализировала DAG
- инициализировала таски 
- задала порядок выполнения танков
- выгрузила DAG в airflow и проверила корректность работы 

**Результаты**: 
* Лог DAG’а
￼![Pasted Graphic 3](https://github.com/ekaterina-drozd/DA-DAG2/assets/158583245/61e37fea-024f-4bd0-9a31-8c820131e6d7)

* Отчет о выполнении DAG’а
￼![Pasted Graphic 2](https://github.com/ekaterina-drozd/DA-DAG2/assets/158583245/29f5560e-e614-44c6-b96d-f446f144ffa2)

